<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HBD Jo!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sour+Gummy:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: "Sour Gummy", sans-serif;
            background-color: #b2ebd8;
            overflow: hidden;
        }

        .main-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            position: relative;
            /* z-index 10 ensures the UI stays above the background */
            z-index: 10; 
        }

        #status-heading {
            color: #333;
            margin-bottom: 25px;
            font-size: 2.5rem;
        }

        .avatar {
            width: 220px;
            height: 220px;
            object-fit: contain;
            margin-bottom: 30px;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .party-avatar {
            transform: scale(1.1) rotate(5deg);
        }

        #celebrate-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            font-family: "Sour Gummy", sans-serif;
            background-color: #b179ff;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(177, 121, 255, 0.4);
            /* z-index 20 ensures the button is ALWAYS on the very top layer */
            position: relative;
            z-index: 20; 
        }

        #celebrate-btn:hover {
            background-color: #9568ff;
            transform: scale(1.05);
        }

        .reset-mode {
            background-color: #ff6060 !important;
            box-shadow: 0 4px 15px rgba(255, 96, 96, 0.4) !important;
        }
    </style>
</head>
<body>

    <audio id="bg-music" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <div class="main-container">
        <h2 id="status-heading">Ready for a Party?</h2>
        <img id="avatar-img" src="avatar01.png" alt="User Avatar" class="avatar">
        <button id="celebrate-btn">Start the Party!</button>
    </div>

    <script>
        /**
         * CANVAS CONFETTI LIBRARY (Minified)
         * Including this directly to ensure it works offline/anywhere.
         */
        !function(e,t){var n={},o=function(e,t){return t=t||n,typeof Symbol=="function"&&Symbol.for?e[Symbol.for("confetti")]=t:e.confetti=t,t}(e,function(){var e=t||{};function t(e,t){return t?t(e):e}function n(e,t,n){return t?t(e,n):e}function o(e){return typeof e=="number"&&!isNaN(e)}function r(e){return e===null||e===undefined}function a(e){return typeof e=="boolean"}function i(e){return typeof e=="string"}function l(e){return typeof e=="function"}function s(e){return Array.isArray(e)}function c(e){return e!==null&&typeof e=="object"&&!s(e)}var u=Object.freeze({color:"#000000",shape:"square",velocity:25,spread:45,rotate:0,alpha:1,scale:1});function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(){function e(e){var t=this;this.canvas=e,this.ctx=e.getContext("2d"),this.particles=[],this.animationId=null,this.render=function(){t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.particles.forEach(function(e,n){e.update(),e.draw(t.ctx),e.alpha<=0&&t.particles.splice(n,1)}),t.particles.length>0?t.animationId=requestAnimationFrame(t.render):t.animationId=null}}var t=e.prototype;return t.addParticle=function(e){this.particles.push(e),this.animationId===null&&this.render()},t.reset=function(){this.particles=[],cancelAnimationFrame(this.animationId),this.animationId=null,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},e}()});

        /* --- REDUCED MINIFIED LIBRARY LOGIC ENDS HERE (Custom implementation for stability) --- */
        /* To ensure 100% stability, I'll use a slightly different but identical-acting logic below */
    </script>

    <script>
        // --- BUILT-IN CONFETTI ENGINE ---
        // Since external libraries are being blocked, let's use a native one-file engine.
        const confettiEngine = {
            particles: [],
            canvas: null,
            ctx: null,
            init() {
                this.canvas = document.createElement('canvas');
                this.canvas.style.position = 'fixed';
                this.canvas.style.top = '0';
                this.canvas.style.left = '0';
                this.canvas.style.width = '100%';
                this.canvas.style.height = '100%';
                this.canvas.style.pointerEvents = 'none';
                this.canvas.style.zIndex = '5'; // Behind button (20) and container (10)
                document.body.appendChild(this.canvas);
                this.ctx = this.canvas.getContext('2d');
                this.resize();
                window.addEventListener('resize', () => this.resize());
            },
            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            },
            spawn() {
                for(let i=0; i<2; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: -20,
                        size: Math.random() * 8 + 4,
                        color: ['#b179ff', '#ff6060', '#00e676', '#ffea00', '#ffffff'][Math.floor(Math.random() * 5)],
                        velX: Math.random() * 2 - 1,
                        velY: Math.random() * 3 + 2,
                        angle: Math.random() * 360,
                        spin: Math.random() * 0.2 - 0.1
                    });
                }
            },
            update() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.particles.forEach((p, i) => {
                    p.y += p.velY;
                    p.x += p.velX;
                    p.angle += p.spin;
                    this.ctx.save();
                    this.ctx.translate(p.x, p.y);
                    this.ctx.rotate(p.angle);
                    this.ctx.fillStyle = p.color;
                    this.ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                    this.ctx.restore();
                    if(p.y > this.canvas.height) this.particles.splice(i, 1);
                });
            }
        };

        confettiEngine.init();

        // --- APP LOGIC ---
        const heading = document.getElementById('status-heading');
        const button = document.getElementById('celebrate-btn');
        const music = document.getElementById('bg-music');
        const avatar = document.getElementById('avatar-img');

        let isCelebrating = false;
        let animationLoop;

        function mainLoop() {
            if (!isCelebrating) return;
            confettiEngine.spawn();
            confettiEngine.update();
            animationLoop = requestAnimationFrame(mainLoop);
        }

        button.onclick = function() {
            if (!isCelebrating) {
                isCelebrating = true;
                heading.innerText = "Happy Birthday! ðŸ•º";
                button.innerText = "Stop the Party";
                button.classList.add('reset-mode');
                avatar.src = "avatar02.png";
                avatar.classList.add('party-avatar');
                
                music.play().catch(() => console.log("Music play blocked by browser."));
                mainLoop();
            } else {
                isCelebrating = false;
                heading.innerText = "Ready for a Party?";
                button.innerText = "Start the Party!";
                button.classList.remove('reset-mode');
                avatar.src = "avatar01.png";
                avatar.classList.remove('party-avatar');
                
                music.pause();
                music.currentTime = 0;
                cancelAnimationFrame(animationLoop);
                confettiEngine.ctx.clearRect(0,0,confettiEngine.canvas.width, confettiEngine.canvas.height);
                confettiEngine.particles = [];
            }
        };
    </script>
</body>
</html>
